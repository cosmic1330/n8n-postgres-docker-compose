upstream n8n_upstream {
    server n8n:5678;
}

server {
    listen 80;
    server_name yangjuiyu.tplinkdns.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name yangjuiyu.tplinkdns.com;

    ssl_certificate /var/www/html/ssl/certificate.crt;
    ssl_certificate_key /var/www/html/ssl/private.key;

    access_log /var/log/nginx/n8n_access.log;
    error_log /var/log/nginx/n8n_error.log;

    # =========================================================
    # 唯一規則：全部由根目錄統一處理
    # =========================================================
    location / {
        proxy_pass http://n8n_upstream;
    }
}